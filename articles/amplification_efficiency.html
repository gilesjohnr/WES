<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Estimating the amplification efficiency of qPCR • WES</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimating the amplification efficiency of qPCR">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-HQPXKPQH2C"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-HQPXKPQH2C');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">WES</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/template_WES_data.html">1. Data templates</a></li>
    <li><a class="dropdown-item" href="../articles/metadata_functions.html">2. Metadata</a></li>
    <li><a class="dropdown-item" href="../articles/derivative_quantities.html">3. qPCR absolute quantification</a></li>
    <li><a class="dropdown-item" href="../articles/derivative_quantities.html">4. qPCR relative quantification</a></li>
    <li><a class="dropdown-item" href="../articles/amplification_efficiency.html">5. qPCR amplification efficiency</a></li>
    <li><a class="dropdown-item" href="../articles/get_climate_data.html">6. Climate data</a></li>
    <li><a class="dropdown-item" href="../articles/calc_hydro_variables.html">7. Hydrological variables</a></li>
    <li><a class="dropdown-item" href="../articles/calc_local_population.html">8. Local population</a></li>
    <li><a class="dropdown-item" href="../articles/get_admin_data.html">9. Administrative boundaries</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gilesjohnr/WES" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimating the amplification efficiency of qPCR</h1>
            
      

      <div class="d-none name"><code>amplification_efficiency.Rmd</code></div>
    </div>

    
    
<p>Adjusting qPCR data according based on amplification efficiency is an
important step for estimating pathogen presence accurately and reliably.
Amplification efficiency refers to how effectively a PCR reaction
duplicates the target nucleic acid in each cycle (see Thermo Fisher’s <a href="https://www.thermofisher.com/us/en/home/life-science/pcr/real-time-pcr/real-time-pcr-learning-center/real-time-pcr-basics/efficiency-real-time-pcr-qpcr.html" class="external-link">Efficiency
of Real-Time PCR</a>). If efficiency of 100% is reached, then the
quantity of the target will double with each cycle. However, variations
in the PCR reactions due to reagents or template quality can degrade
efficiency <span class="citation">(<a href="#ref-stolovitzky1996">Stolovitzky and Cecchi 1996</a>)</span>. It
is also likely that when performing environmental sampling, there will
be additional inhibitors for the environment in the sample that may
cause further inefficiency of the PCR reaction. Therefore, it is
important to quantify and account for these inefficiencies because they
can lead to significant inaccuracies in the quantification of gene
expression levels and subsequent detection of pathogens.</p>
<div class="section level2">
<h2 id="estimation-of-amplification-efficiency-using-the-standard-curve-method">Estimation of amplification efficiency using the standard curve
method<a class="anchor" aria-label="anchor" href="#estimation-of-amplification-efficiency-using-the-standard-curve-method"></a>
</h2>
<p>We have included two functions
(<code><a href="../reference/est_amplification_efficiency.html">est_amplification_efficiency()</a></code> and
<code><a href="../reference/apply_amplification_efficiency.html">apply_amplification_efficiency()</a></code>) to assist in efficiency
calculations. These functions use the standard curve method to estimate
the percentile amplification efficiency for each target in the provided
standard curve data <span class="citation">(<a href="#ref-yuan2008">Yuan, Wang, and Stewart 2008</a>; <a href="#ref-yuan2006">Yuan et al. 2006</a>)</span>. Note that data must
be in the standardized format described in the
<code>template_WES_standard_curve</code> data object. To estimate the
percentile amplification efficiency
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>,
we fit the following linear model to get the slope
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mtext mathvariant="normal">efficiency</mtext></msub><annotation encoding="application/x-tex">\beta_{\text{efficiency}}</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">Ct</mtext><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>α</mi><mo>+</mo><msub><mi>β</mi><mtext mathvariant="normal">efficiency</mtext></msub><msub><mtext mathvariant="normal">log</mtext><mn>2</mn></msub><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo><mo>+</mo><mi>ϵ</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">\text{Ct}_{ij} = \alpha + \beta_{\text{efficiency}} \text{log}_2\big(S_{ij}\big) + \epsilon.</annotation></semantics></math></p>
<p>Where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">S_{ij}</annotation></semantics></math>
is the serially diluted concentration of the target nucleic acid for
observation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and gene target
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>,
and the percentile amplification efficiency is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo>=</mo><mo>−</mo><msub><mi>β</mi><mtext mathvariant="normal">efficiency</mtext></msub></mrow><annotation encoding="application/x-tex">\phi = -\beta_{\text{efficiency}}</annotation></semantics></math>.
Assuming that the standard curve assay contains greater than 5
observations and target concentrations double with each serial dilution,
we expect that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\phi = 1</annotation></semantics></math>
in the case of perfect efficiency and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\phi &lt; 1</annotation></semantics></math>
otherwise.</p>
<center>
<img src="../reference/figures/plot_efficiency.png" style="width:50.0%">
</center>
<p>The following code will estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>
and its 95% confidence intervals for a single target using
<code><a href="../reference/est_amplification_efficiency.html">est_amplification_efficiency()</a></code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>sel <span class="ot">&lt;-</span> template_WES_standard_curve<span class="sc">$</span>target_name <span class="sc">==</span> <span class="st">'target_3'</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>tmp_n_copies <span class="ot">&lt;-</span> template_WES_standard_curve<span class="sc">$</span>n_copies[sel]</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>tmp_ct_value <span class="ot">&lt;-</span> template_WES_standard_curve<span class="sc">$</span>ct_value[sel]</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">est_amplification_efficiency</span>(<span class="at">n_copies =</span> tmp_n_copies,</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>                             <span class="at">ct_value =</span> tmp_ct_value)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="sc">$</span>mean</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.9718572</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="sc">$</span>ci_lo</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.221067</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="sc">$</span>ci_hi</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.7226478</span></span></code></pre></div>
<p>And <code><a href="../reference/apply_amplification_efficiency.html">apply_amplification_efficiency()</a></code> will apply the same
function to all gene targets within a data frame following the format of
the <code>template_WES_standard_curve</code> data object:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">apply_amplification_efficiency</span>(template_WES_standard_curve)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  target_name      mean    ci_lo     ci_hi</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="dv">1</span>    target_0 <span class="fl">1.0728651</span> <span class="fl">1.376872</span> <span class="fl">0.7688578</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="dv">2</span>    target_1 <span class="fl">1.0604787</span> <span class="fl">1.187228</span> <span class="fl">0.9337295</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="dv">3</span>    target_2 <span class="fl">1.1259549</span> <span class="fl">1.407022</span> <span class="fl">0.8448880</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="dv">4</span>    target_3 <span class="fl">0.9718572</span> <span class="fl">1.221067</span> <span class="fl">0.7226478</span></span></code></pre></div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-stolovitzky1996" class="csl-entry">
Stolovitzky, G., and G. Cecchi. 1996. <span>“Efficiency of DNA
replication in the polymerase chain reaction.”</span> <em>Proceedings of
the National Academy of Sciences of the United States of America</em> 93
(23): 12947–52. <a href="https://doi.org/10.1073/pnas.93.23.12947" class="external-link">https://doi.org/10.1073/pnas.93.23.12947</a>.
</div>
<div id="ref-thermofisherscientific2024" class="csl-entry">
Thermo Fisher Scientific. 2024. <span>“Efficiency of Real-Time
PCR.”</span> <a href="https://www.thermofisher.com/us/en/home/life-science/pcr/real-time-pcr/real-time-pcr-learning-center/real-time-pcr-basics/efficiency-real-time-pcr-qpcr.html" class="external-link">https://www.thermofisher.com/us/en/home/life-science/pcr/real-time-pcr/real-time-pcr-learning-center/real-time-pcr-basics/efficiency-real-time-pcr-qpcr.html</a>.
</div>
<div id="ref-yuan2006" class="csl-entry">
Yuan, Joshua S., Ann Reed, Feng Chen, and C Neal Stewart. 2006.
<span>“Statistical Analysis of Real-Time PCR Data.”</span> <em>BMC
Bioinformatics</em> 7 (1): 85. <a href="https://doi.org/10.1186/1471-2105-7-85" class="external-link">https://doi.org/10.1186/1471-2105-7-85</a>.
</div>
<div id="ref-yuan2008" class="csl-entry">
Yuan, Joshua S., Donglin Wang, and C. Neal Stewart. 2008.
<span>“Statistical Methods for Efficiency Adjusted
Real<span>-</span>Time PCR Quantification.”</span> <em>Biotechnology
Journal</em> 3 (1): 112–23. <a href="https://doi.org/10.1002/biot.200700169" class="external-link">https://doi.org/10.1002/biot.200700169</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by John R Giles.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
